"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8707],{8707:(x,h,l)=>{l.r(h),l.d(h,{CarritoPageModule:()=>k});var g=l(177),f=l(4341),r=l(9364),p=l(8986),u=l(467),t=l(4438),C=l(9845);function b(o,a){if(1&o){const n=t.RV6();t.j41(0,"ion-item-sliding",7)(1,"ion-item",7)(2,"ion-grid",7)(3,"ion-row")(4,"ion-col",10)(5,"div",11),t.nrm(6,"ion-img",12),t.j41(7,"ion-badge",13),t.EFF(8),t.k0s()()(),t.j41(9,"ion-col",14)(10,"ion-label",15),t.EFF(11,"Nombre"),t.k0s(),t.j41(12,"ion-label"),t.EFF(13),t.k0s(),t.j41(14,"ion-label",15),t.EFF(15,"Precio"),t.k0s(),t.j41(16,"ion-label"),t.EFF(17),t.k0s()()()()(),t.j41(18,"ion-item-options",16)(19,"ion-item-option",2),t.bIt("click",function(){const i=t.eBV(n).index,s=t.XpG(2);return t.Njj(s.borrarProducto(i))}),t.nrm(20,"ion-icon",17),t.k0s()()()}if(2&o){const n=a.$implicit,e=t.XpG(2);t.R7$(6),t.Y8G("src",n.getImage()),t.R7$(2),t.JRh(e.countProductsInOrder(n)),t.R7$(5),t.JRh(n.getName()),t.R7$(4),t.SpI("",n.getPrice(),"\u20ac")}}function P(o,a){if(1&o&&(t.j41(0,"ion-content",7)(1,"ion-list",8),t.DNE(2,b,21,4,"ion-item-sliding",9),t.k0s()()),2&o){const n=t.XpG();t.R7$(2),t.Y8G("ngForOf",n.listaCarritoSinDuplicados)}}function v(o,a){1&o&&(t.j41(0,"ion-content",7)(1,"div",18)(2,"ion-label",19),t.EFF(3,"\xbfTodav\xeda no te decides?"),t.k0s(),t.nrm(4,"br")(5,"ion-icon",20),t.k0s()())}const y=[{path:"",component:(()=>{var o;class a{constructor(e,i,s){this.servicio=e,this.allertController=i,this.router=s,this.mesaSeleccionada=this.servicio.getMesaSeleccionada()}ngOnInit(){this.listaCarritoSinDuplicados=new Array,this.servicio.get$ListaCarrito().subscribe(e=>{this.listaCarritoSinDuplicados=new Array,this.listaCarrito=e,this.listaCarrito.forEach(i=>{this.listaCarritoSinDuplicados.push(i)}),this.calcularTotal(),this.eliminarDuplicados()})}vaciarCarrito(){this.servicio.vaciarCarrito(),this.listaCarrito=[],this.listaCarritoSinDuplicados=[],this.sumaTotal=0}borrarProducto(e){let i=this.listaCarrito[e];this.listaCarrito.splice(e,1),this.calcularTotal(),this.checkIfEmpty(i)}checkIfEmpty(e){0===this.countProductsInOrder(e)&&(this.listaCarritoSinDuplicados=this.listaCarritoSinDuplicados.filter(i=>i.getId()!=e.getId()))}countProductsInOrder(e){return this.servicio.countProductsInOrder(e)}eliminarDuplicados(){let e=new Set;this.listaCarritoSinDuplicados=this.listaCarrito.filter((i,s)=>!e.has(i.getId())&&(e.add(i.getId()),!0))}calcularTotal(){this.sumaTotal=0,this.listaCarrito.forEach(e=>{let i=this.sumaTotal+e.getPrice();this.sumaTotal=i})}crearPedido(){var e=this;return(0,u.A)(function*(){if(0!=e.listaCarrito.length){let i=[];e.listaCarrito.forEach(c=>{i.push(c.getId())});let s=e.mesaSeleccionada,d=yield e.requestDescriptionOfOrder();""===d&&(d="No hay ninguna descripci\xf3n para este pedido"),e.servicio.realizarPedido({tableNumber:s,products:i,totalPrice:e.sumaTotal,orderDescription:d}).subscribe(c=>{console.log("Pedido realizado con \xe9xito",c),e.crearAlerta()},c=>{console.error("Error al realizar el pedido",c)}),e.listaCarrito=[],e.servicio.vaciarCarrito(),e.router.navigate(["/home/"+e.mesaSeleccionada])}else yield(yield e.allertController.create({header:"Seleccione al menos un producto",subHeader:"No se puede realizar un pedido sin productos",buttons:["OK"]})).present()})()}requestDescriptionOfOrder(){var e=this;return(0,u.A)(function*(){return new Promise(function(){var i=(0,u.A)(function*(s,d){yield(yield e.allertController.create({header:"Algo que quieras hacer saber al camarero?",inputs:[{name:"descripcion",type:"textarea",placeholder:"Escribe aqu\xed"}],buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary",handler:()=>{s("No hay ninguna descripci\xf3n para este pedido")}},{text:"Enviar",handler:c=>{s(c.descripcion)}}]})).present()});return function(s,d){return i.apply(this,arguments)}}())})()}crearAlerta(){var e=this;return(0,u.A)(function*(){yield(yield e.allertController.create({header:"Su pedido ha llegado a cocina",subHeader:"En breves momentos podr\xe1 disfrutar de lo que ha pedido. Gracias por confiar en nosotros",buttons:["OK"]})).present()})()}}return(o=a).\u0275fac=function(e){return new(e||o)(t.rXU(C.a),t.rXU(r.hG),t.rXU(p.Ix))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-carrito"]],decls:10,vars:3,consts:[["color","dark",4,"ngIf"],["vertical","bottom","horizontal","start","slot","fixed"],["color","danger",3,"click"],["name","trash"],["vertical","bottom","horizontal","end","slot","fixed"],["color","success",3,"click"],["name","restaurant"],["color","dark"],["lines","inset","color","dark",1,"items-align-text-center"],["color","dark",4,"ngFor","ngForOf"],["size","4","color","dark"],[1,"contenedor"],[1,"imagenes",3,"src"],[1,"counter"],["size","8"],[1,"bold"],["side","end"],["slot","icon-only","name","trash"],[1,"containerWithoutElements"],[1,"labelSinProductos"],["name","fast-food-outline","id","icono"]],template:function(e,i){1&e&&(t.DNE(0,P,3,1,"ion-content",0)(1,v,6,0,"ion-content",0),t.j41(2,"ion-fab",1)(3,"ion-fab-button",2),t.bIt("click",function(){return i.vaciarCarrito()}),t.nrm(4,"ion-icon",3),t.k0s()(),t.j41(5,"ion-fab",4)(6,"ion-fab-button",5),t.bIt("click",function(){return i.crearPedido()}),t.nrm(7,"ion-icon",6),t.j41(8,"ion-label"),t.EFF(9),t.k0s()()()),2&e&&(t.Y8G("ngIf",i.listaCarritoSinDuplicados.length>0),t.R7$(),t.Y8G("ngIf",0===i.listaCarritoSinDuplicados.length),t.R7$(8),t.SpI("",i.sumaTotal,"\u20ac"))},dependencies:[g.Sq,g.bT,r.In,r.hU,r.W9,r.Q8,r.YW,r.lO,r.iq,r.KW,r.uz,r.LU,r.CE,r.A7,r.he,r.nf,r.ln],styles:[".contenedor[_ngcontent-%COMP%]{width:100px;height:100px;position:relative;background-color:#222428}.imagenes[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.counter[_ngcontent-%COMP%]{position:absolute;left:-7px;top:-8px;background-color:gold;color:#fff;border-radius:100%;width:20px;height:20px;align-items:center;justify-content:center;font-size:14px}.containerWithoutElements[_ngcontent-%COMP%]{text-align:center;margin-top:150px;font-family:Georgia,Times New Roman,Times,serif;font-size:30px;font-style:italic;background-color:#222428;background-attachment:fixed;background-position:center;justify-content:center}ion-col[_ngcontent-%COMP%]{text-align:center}.bold[_ngcontent-%COMP%]{font-weight:700}.labelSinProductos[_ngcontent-%COMP%]{-webkit-text-decoration:solid;text-decoration:solid;font-family:Georgia,Times New Roman,Times,serif;font-size:30px;font-style:italic;color:gray}#icono[_ngcontent-%COMP%]{font-size:50px;color:gray}ion-list[_ngcontent-%COMP%]{margin:0;padding:0}"]}),a})()}];let _=(()=>{var o;class a{}return(o=a).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[p.iI.forChild(y),p.iI]}),a})(),k=(()=>{var o;class a{}return(o=a).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[g.MD,f.YN,r.bv,_]}),a})()}}]);